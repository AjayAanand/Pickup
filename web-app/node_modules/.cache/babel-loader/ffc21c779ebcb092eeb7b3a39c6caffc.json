{"ast":null,"code":"import React,{useEffect}from\"react\";import CircularLoading from\"../components/CircularLoading\";import{useSelector,useDispatch}from\"react-redux\";import{api}from\"common\";import i18n from\"i18next\";import{useTranslation}from\"react-i18next\";import moment from\"moment/min/moment-with-locales\";import{jsx as _jsx}from\"react/jsx-runtime\";function AuthLoading(props){var _useTranslation=useTranslation(),t=_useTranslation.t;var fetchUser=api.fetchUser,fetchCarTypes=api.fetchCarTypes,fetchSettings=api.fetchSettings,fetchBookings=api.fetchBookings,fetchCancelReasons=api.fetchCancelReasons,fetchPromos=api.fetchPromos,fetchDriverEarnings=api.fetchDriverEarnings,fetchUsers=api.fetchUsers,fetchNotifications=api.fetchNotifications,fetchEarningsReport=api.fetchEarningsReport,signOff=api.signOff,fetchWithdraws=api.fetchWithdraws,fetchPaymentMethods=api.fetchPaymentMethods,fetchLanguages=api.fetchLanguages,fetchWalletHistory=api.fetchWalletHistory,fetchCars=api.fetchCars,fetchSMTP=api.fetchSMTP;var dispatch=useDispatch();var auth=useSelector(function(state){return state.auth;});var languagedata=useSelector(function(state){return state.languagedata;});var settingsdata=useSelector(function(state){return state.settingsdata;});useEffect(function(){dispatch(fetchSettings());},[dispatch,fetchSettings]);useEffect(function(){if(languagedata.langlist){for(var _i=0,_Object$values=Object.values(languagedata.langlist);_i<_Object$values.length;_i++){var value=_Object$values[_i];if(value.default===true){i18n.addResourceBundle(value.langLocale,\"translations\",value.keyValuePairs);i18n.changeLanguage(value.langLocale);moment.locale(value.dateLocale);}}dispatch(fetchUser());}},[languagedata,dispatch,fetchUser]);useEffect(function(){if(settingsdata.settings){dispatch(fetchLanguages());dispatch(fetchCarTypes());document.title=settingsdata.settings.appName;}},[settingsdata.settings,dispatch,fetchLanguages,fetchCarTypes]);useEffect(function(){if(auth.profile){if(auth.profile.usertype){var role=auth.profile.usertype;if(role===\"customer\"){dispatch(fetchBookings());dispatch(fetchWalletHistory());dispatch(fetchPaymentMethods());dispatch(fetchCancelReasons());dispatch(fetchUsers());}else if(role===\"driver\"){dispatch(fetchBookings());dispatch(fetchWithdraws());dispatch(fetchPaymentMethods());dispatch(fetchCars());dispatch(fetchWalletHistory());}else if(role===\"admin\"){dispatch(fetchUsers());dispatch(fetchBookings());dispatch(fetchPromos());dispatch(fetchDriverEarnings());dispatch(fetchNotifications());dispatch(fetchEarningsReport());dispatch(fetchCancelReasons());dispatch(fetchWithdraws());dispatch(fetchPaymentMethods());dispatch(fetchCars());dispatch(fetchSMTP());}else if(role===\"fleetadmin\"){dispatch(fetchUsers());dispatch(fetchBookings());dispatch(fetchDriverEarnings());dispatch(fetchCars());dispatch(fetchCancelReasons());}else{alert(t(\"not_valid_user_type\"));dispatch(signOff());}}else{alert(t(\"user_issue_contact_admin\"));dispatch(signOff());}}},[auth.profile,dispatch,fetchBookings,fetchCancelReasons,fetchDriverEarnings,fetchEarningsReport,fetchNotifications,fetchPromos,fetchUsers,fetchWithdraws,signOff,fetchPaymentMethods,fetchWalletHistory,fetchCars,fetchSMTP,t]);return settingsdata.loading?/*#__PURE__*/_jsx(CircularLoading,{}):settingsdata.settings?auth.loading||!languagedata.langlist?/*#__PURE__*/_jsx(CircularLoading,{}):props.children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{children:\"No Database Settings found\"})});}export default AuthLoading;","map":{"version":3,"names":["React","useEffect","CircularLoading","useSelector","useDispatch","api","i18n","useTranslation","moment","jsx","_jsx","AuthLoading","props","_useTranslation","t","fetchUser","fetchCarTypes","fetchSettings","fetchBookings","fetchCancelReasons","fetchPromos","fetchDriverEarnings","fetchUsers","fetchNotifications","fetchEarningsReport","signOff","fetchWithdraws","fetchPaymentMethods","fetchLanguages","fetchWalletHistory","fetchCars","fetchSMTP","dispatch","auth","state","languagedata","settingsdata","langlist","_i","_Object$values","Object","values","length","value","default","addResourceBundle","langLocale","keyValuePairs","changeLanguage","locale","dateLocale","settings","document","title","appName","profile","usertype","role","alert","loading","children"],"sources":["/Users/sumitbajaj/Downloads/TAXI-PICK/Sourcecode/web-app/src/views/AuthLoading.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport CircularLoading from \"../components/CircularLoading\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { api } from \"common\";\r\nimport i18n from \"i18next\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport moment from \"moment/min/moment-with-locales\";\r\n\r\nfunction AuthLoading(props) {\r\n  const { t } = useTranslation();\r\n  const {\r\n    fetchUser,\r\n    fetchCarTypes,\r\n    fetchSettings,\r\n    fetchBookings,\r\n    fetchCancelReasons,\r\n    fetchPromos,\r\n    fetchDriverEarnings,\r\n    fetchUsers,\r\n    fetchNotifications,\r\n    fetchEarningsReport,\r\n    signOff,\r\n    fetchWithdraws,\r\n    fetchPaymentMethods,\r\n    fetchLanguages,\r\n    fetchWalletHistory,\r\n    fetchCars,\r\n    fetchSMTP\r\n  } = api;\r\n  const dispatch = useDispatch();\r\n  const auth = useSelector((state) => state.auth);\r\n  const languagedata = useSelector((state) => state.languagedata);\r\n  const settingsdata = useSelector((state) => state.settingsdata);\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchSettings());\r\n  }, [dispatch, fetchSettings]);\r\n\r\n  useEffect(() => {\r\n    if (languagedata.langlist) {\r\n      for (const value of Object.values(languagedata.langlist)) {\r\n        if (value.default === true) {\r\n          i18n.addResourceBundle(\r\n            value.langLocale,\r\n            \"translations\",\r\n            value.keyValuePairs\r\n          );\r\n          i18n.changeLanguage(value.langLocale);\r\n          moment.locale(value.dateLocale);\r\n        }\r\n      }\r\n      dispatch(fetchUser());\r\n    }\r\n  }, [languagedata, dispatch, fetchUser]);\r\n\r\n  useEffect(() => {\r\n    if (settingsdata.settings) {\r\n      dispatch(fetchLanguages());\r\n      dispatch(fetchCarTypes());\r\n      document.title = settingsdata.settings.appName;\r\n    }\r\n  }, [settingsdata.settings, dispatch, fetchLanguages, fetchCarTypes]);\r\n\r\n  useEffect(() => {\r\n    if (auth.profile) {\r\n      if (auth.profile.usertype) {\r\n        let role = auth.profile.usertype;\r\n        if (role === \"customer\") {\r\n          dispatch(fetchBookings());\r\n          dispatch(fetchWalletHistory());\r\n          dispatch(fetchPaymentMethods());\r\n          dispatch(fetchCancelReasons());\r\n          dispatch(fetchUsers());\r\n        } else if (role === \"driver\") {\r\n          dispatch(fetchBookings());\r\n          dispatch(fetchWithdraws());\r\n          dispatch(fetchPaymentMethods());\r\n          dispatch(fetchCars());\r\n          dispatch(fetchWalletHistory());\r\n        } else if (role === \"admin\") {\r\n          dispatch(fetchUsers());\r\n          dispatch(fetchBookings());\r\n          dispatch(fetchPromos());\r\n          dispatch(fetchDriverEarnings());\r\n          dispatch(fetchNotifications());\r\n          dispatch(fetchEarningsReport());\r\n          dispatch(fetchCancelReasons());\r\n          dispatch(fetchWithdraws());\r\n          dispatch(fetchPaymentMethods());\r\n          dispatch(fetchCars());\r\n          dispatch(fetchSMTP());\r\n        } else if (role === \"fleetadmin\") {\r\n          dispatch(fetchUsers());\r\n          dispatch(fetchBookings());\r\n          dispatch(fetchDriverEarnings());\r\n          dispatch(fetchCars());\r\n          dispatch(fetchCancelReasons());\r\n        } else {\r\n          alert(t(\"not_valid_user_type\"));\r\n          dispatch(signOff());\r\n        }\r\n      } else {\r\n        alert(t(\"user_issue_contact_admin\"));\r\n        dispatch(signOff());\r\n      }\r\n    }\r\n  }, [\r\n    auth.profile,\r\n    dispatch,\r\n    fetchBookings,\r\n    fetchCancelReasons,\r\n    fetchDriverEarnings,\r\n    fetchEarningsReport,\r\n    fetchNotifications,\r\n    fetchPromos,\r\n    fetchUsers,\r\n    fetchWithdraws,\r\n    signOff,\r\n    fetchPaymentMethods,\r\n    fetchWalletHistory,\r\n    fetchCars,\r\n    fetchSMTP,\r\n    t\r\n  ]);\r\n\r\n  return settingsdata.loading ? (\r\n    <CircularLoading />\r\n  ) : settingsdata.settings ? (\r\n    auth.loading || !languagedata.langlist ? (\r\n      <CircularLoading />\r\n    ) : (\r\n      props.children\r\n    )\r\n  ) : (\r\n    <div>\r\n      <span>No Database Settings found</span>\r\n  </div>\r\n  );\r\n}\r\n\r\nexport default AuthLoading;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}