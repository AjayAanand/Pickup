{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sumitbajaj/Downloads/TAXI-PICK/Sourcecode/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/sumitbajaj/Downloads/TAXI-PICK/Sourcecode/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{FETCH_CAR_TYPES,FETCH_CAR_TYPES_SUCCESS,FETCH_CAR_TYPES_FAILED,EDIT_CAR_TYPE}from\"../store/types\";import store from'../store/store';import{firebase}from'../config/configureFirebase';import{onValue,set,remove,push}from\"firebase/database\";import{uploadBytesResumable,getDownloadURL}from\"firebase/storage\";export var fetchCarTypes=function fetchCarTypes(){return function(dispatch){var carTypesRef=firebase.carTypesRef;dispatch({type:FETCH_CAR_TYPES,payload:null});onValue(carTypesRef,function(snapshot){if(snapshot.val()){var data=snapshot.val();var arr=Object.keys(data).map(function(i){data[i].id=i;return data[i];});dispatch({type:FETCH_CAR_TYPES_SUCCESS,payload:arr});}else{dispatch({type:FETCH_CAR_TYPES_FAILED,payload:store.getState().languagedata.defaultLanguage.no_cars});}});};};export var editCarType=function editCarType(cartype,method){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var carTypesRef,carTypesEditRef,carDocImage,image,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:carTypesRef=firebase.carTypesRef,carTypesEditRef=firebase.carTypesEditRef,carDocImage=firebase.carDocImage;dispatch({type:EDIT_CAR_TYPE,payload:{method:method,cartype:cartype}});if(!(method==='Add')){_context.next=6;break;}push(carTypesRef,cartype);_context.next=22;break;case 6:if(!(method==='Delete')){_context.next=10;break;}remove(carTypesEditRef(cartype.id));_context.next=22;break;case 10:if(!(method==='UpdateImage')){_context.next=21;break;}_context.next=13;return uploadBytesResumable(carDocImage(cartype.id),cartype.image);case 13:_context.next=15;return getDownloadURL(carDocImage(cartype.id));case 15:image=_context.sent;data=cartype;data.image=image;set(carTypesEditRef(cartype.id),data);_context.next=22;break;case 21:set(carTypesEditRef(cartype.id),cartype);case 22:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};","map":{"version":3,"names":["FETCH_CAR_TYPES","FETCH_CAR_TYPES_SUCCESS","FETCH_CAR_TYPES_FAILED","EDIT_CAR_TYPE","store","firebase","onValue","set","remove","push","uploadBytesResumable","getDownloadURL","fetchCarTypes","dispatch","carTypesRef","type","payload","snapshot","val","data","arr","Object","keys","map","i","id","getState","languagedata","defaultLanguage","no_cars","editCarType","cartype","method","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","carTypesEditRef","carDocImage","image","wrap","_callee$","_context","prev","next","sent","stop","_x","apply","arguments"],"sources":["/Users/sumitbajaj/Downloads/TAXI-PICK/Sourcecode/common/src/actions/cartypeactions.js"],"sourcesContent":["import {\r\n  FETCH_CAR_TYPES,\r\n  FETCH_CAR_TYPES_SUCCESS,\r\n  FETCH_CAR_TYPES_FAILED,\r\n  EDIT_CAR_TYPE\r\n} from \"../store/types\";\r\nimport store from '../store/store';\r\nimport { firebase } from '../config/configureFirebase';\r\nimport { onValue, set ,remove, push } from \"firebase/database\";\r\nimport { uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\r\n\r\nexport const fetchCarTypes = () => (dispatch) => {\r\n\r\n  const {\r\n    carTypesRef\r\n  } = firebase;\r\n\r\n  dispatch({\r\n    type: FETCH_CAR_TYPES,\r\n    payload: null\r\n  });\r\n  onValue(carTypesRef, snapshot => {\r\n    if (snapshot.val()) {\r\n      let data = snapshot.val();\r\n      const arr = Object.keys(data).map(i => {\r\n        data[i].id = i;\r\n        return data[i]\r\n      });\r\n      dispatch({\r\n        type: FETCH_CAR_TYPES_SUCCESS,\r\n        payload: arr\r\n      });\r\n    } else {\r\n      dispatch({\r\n        type: FETCH_CAR_TYPES_FAILED,\r\n        payload: store.getState().languagedata.defaultLanguage.no_cars\r\n      });\r\n    }\r\n  });\r\n};\r\n\r\nexport const editCarType = (cartype, method) => async (dispatch) => {\r\n  const {\r\n    carTypesRef, \r\n    carTypesEditRef,\r\n    carDocImage\r\n  } = firebase;\r\n  dispatch({\r\n    type: EDIT_CAR_TYPE,\r\n    payload: { method, cartype }\r\n  });\r\n  if (method === 'Add') {\r\n    push(carTypesRef, cartype);\r\n  } else if (method === 'Delete') {\r\n    remove(carTypesEditRef(cartype.id));\r\n  } else if (method === 'UpdateImage') {\r\n    await uploadBytesResumable(carDocImage(cartype.id), cartype.image);\r\n    let image = await getDownloadURL(carDocImage(cartype.id));\r\n      let data = cartype;\r\n      data.image = image;\r\n    set(carTypesEditRef(cartype.id), data);\r\n  }\r\n   else {\r\n    set(carTypesEditRef(cartype.id), cartype);\r\n  }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}